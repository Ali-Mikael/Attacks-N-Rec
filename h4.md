# NFC & RFID

## Intro
What is NFC/RFID?
- Both technologies use radio waves to communicate data at a distance.
- Can be used in passive or active mode.
  - **Passive**: Only sending signals when in contact with a reader (powered by the active device's electromagnetic field).
  - **Active**: *Two-way communication*. Requires both RFID/NFC enabled devices to have a power source.
- The biggest difference => *range* and *frequency*.
- They also differ in application and operation.
- Once could say, that NFC if part of the RFID family.

**NFC**, or *Near Field Communication*:
- Range: 0-5cm (*theoretical limit* is 20cm to my understanding).
- Uses 13.56 MHz.     

**RFID**, or *Radio Frequency Identification*:
- Range up to a 100m + (Depends on mode (passive/active) and band used).
- Uses various frequency bands.

**Sources used:**
- <https://www.geeksforgeeks.org/electronics-engineering/difference-between-near-field-communication-nfc-and-radio-frequency-identification-rfid/>
- <https://iotjourney.orange.com/en/support/faq/what-is-the-difference-between-nfc-and-rfid>

## 1. Inspect RFID products that you use, ponder how well you are protected against RFID prying.
I have two RFID products I use the most:
- Contactless payment and passport.
- The passport I don't use every day, but when once in a while travelling, I should probably have some sort of faraday cage for it, as I don't have any safety mechanism for it at the moment.
  - Nefarious actors reading this: Don't even think about it!
- What comes to my credit card, I do have a wallet that's supposed to block NFC skimming etc, so in theory I should be covered.
- Interesting idea that came to mind:
  - Could somebody place a rougue reader of their own (small in size and hiding in plain sight), between a reader and card, in order to eavesdrop during a transaction?
  - I asked ChatGPT (the prompt being verbatum the question above).     
**Answer:**
Short answer:   
- In theory yes, but in practice it's extremely unlikely and almost useless.
- A rogue NFC reader could be placed physically between the card and the real terminal, but:
  - It must be paper-thin and very close
  - It often breaks the transaction
  - EMV contactless data is encrypted and one-time-use, so captured data cannot be reused or cloned
  - So while technically possible, itâ€™s not a practical or effective attack.

Found an interesting video through the link Lari provided (<https://bishopfox.com/tools/rfid-hacking-2/attack-tools>).     
The video shows how easily an unprotected card can be skimmed from a distance.
- <https://www.youtube.com/watch?v=gP9f_TiKHIY>
- Device: **Tastic RFID Thief**
  - "A silent, long-range RFID reader that can steal the proximity badge information"
  - Source: The link provided by Lari.
- Obviously this is not the most discreet device, but hiding in a backpack, you could easily read a bypassers card. 

## 2. Familiarize yourself with the structure of APDU commands (you can use AI)
APDU, or Application Protocol Data Unit, defines the message format for communications between smart cards and readers.
Just like the OSI model uses different PDUs at each layer:
- "Frames" at layer 2, "packets" at layer 3, and "segments"/"datagrams" at layer 4.
APDUs are the message units used in smart card communication.     
An APDU can be either a *command* or *response*. The structure is defined by ISO/IEC 7816-4.     

#### APDU Command(C-APDU):
Sent by a host system to the card, in order to request a specific *action* or *operation*.     
Consists of =>
- **Class Byte (CLA)**
  - Command class && operation category.
- **Instuction Byte (INS)**
  - Command or operation to be performed.
- **Parameter 1 Byte (P1)**
  - Optional data/parameters.
- **Parameter 2 Byte (P2)**
  - Optional data/parameters.
- **Length Expected (LE)**
  - Expected length of response data.     

**Two Types of C-APDU**
  1. Commonly known as the "Escape command", which is usually sent to control the hardware (leds, buzzers, config data etc).
  2. The other type is for collecting data from the smart card (NFC tag).     

**10 Most Common APDU Commands:**
1. SELECT FILE (0x00A4)
2. READ BINARY  (0x00B0)
3. UPDATE BINARY (0x00D6)
4. READ RECORDDS  (0x00DC)
5. UPDATE RECORD   (0x00DC)
6. APPEND RECORD    (0x00E2)
7. VERIFY            (0x0020)
8. CHANGE REFERENCE DATA (0x0024)
9. RESET RETRY COUNTER (0x002C)
10. GET CHALLENGE    (0X0084)     

#### APDU Response (R-APDU):
Response data from the card.    
Consists of =>
- **Data field**
  - The response data.
  - a.k.a *Requested information* or *result of the command* (operation)
- **Status Word (SW1, SW2)**
  - Two bytes, containing information about the status of the operation. (success, error, warnings)

**10 APDU Responses (short list, no specific order):**
1. Class not supported
2. Response bytes still available
3. Command succesfully executed; 'XX' bytes of data available, can be requested using GET RESPONSE
4. Selected file invalidated
5. Wrong R-MAC
6. Card locked (during reset())
7. Cardholder locked
8. Default agent locked
9. Card key not supported
10. Key length is not correct     

**Sources:**
- <https://www.cardlogix.com/glossary/apdu-application-protocol-data-unit-smart-card/>
- <https://www.passninja.com/tutorials/nfc-protocols/what-are-apdus>
- <https://www.eftlab.com/knowledge-base/complete-list-of-apdu-responses>     

## 3. Investigate and inform on interesting RFID hacking news.
Hardware Backdoor Discovered in RFID Cards Used in Hotels and Offices Worldwide    
> <https://thehackernews.com/2024/08/hardware-backdoor-discovered-in-rfid.html>     
> Published: 8.22.2024     
> URL accessed: 27.11.2025     

#### Summary
- A backdoor was found within a particular model of MIFARE Classic contactless cards (model FM11RF08S).
  - Which apparently can be found on their other cards as well, in various flavors.
- "The backdoor enables any entity with knowledge of it to compromise all user-defined keys on these cards, even when fully diversified, simply by accessing the card for a few minutes."
- It allows authentication with an unkown key, and ultimately open rooms and doors inside hotels and offices.
- The backdoor allows the instantaneous cloning of RFID smart cards.
- It was said, that an attacker in a position to carry out a supply chain attack, could execute such attacks instantaneously at scale.
- The cards in question were not only found in china, but also in hotels across Europe, India and the US.

The introduction in the articles *source blog post* to get your attention:          
"*We studied the most secure static encrypted nonce variant of "MIFARE Classic compatible" cards 
-- meant to resist all known card-only attacks -- 
and developed new attacks defeating it, uncovering a hardware backdoor in the process. 
And that's only the beginning...*"    

Very fascinating stuff!

The more **technical report** and source for the article:
- <https://blog.quarkslab.com/mifare-classic-static-encrypted-nonce-and-backdoors.html>     

The **tools and attacks** developed by the researchers:
- <https://github.com/RfidResearchGroup/proxmark3>     

The **full paper** can be found at:
- <https://eprint.iacr.org/2024/1275>


