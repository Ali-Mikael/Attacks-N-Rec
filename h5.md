# Lab and simulation environments in attacks

# A) Tools
Familiarize yourself with the tool: **Evilginx** <https://github.com/kgretzky/evilginx2>     
Answer the following questions:
- Did you install the tool, and how did you do it?
- What did you do with the tool?
- Were you succesfull in spoofing traffic?

### Walkthrough
I installed the tool on my Kali-VM (the VM uses a bridged adapter, so that I can test it out in my own LAN).      

Install using:
```
$ sudo apt install evilginx2
```
- <img width="790" height="339" alt="Screenshot from 2025-11-23 22-54-42" src="https://github.com/user-attachments/assets/fd806af2-a535-4322-a8e5-c0b70777d464" />     

Launch by typing:
```
$ evilginx2
```
- <img width="994" height="612" alt="Screenshot from 2025-11-24 10-06-50" src="https://github.com/user-attachments/assets/ff14f7b3-09a2-4c9e-a96b-4fce0c6d1c90" />     
 
Set up domain and IP (i'm trying this out in my local network)
```
: config domain safe-domain
```
```
: config ipv4 external <ip-of-my-vm-running-evilginx>
```
 - <img width="905" height="146" alt="Screenshot from 2025-11-24 10-25-51" src="https://github.com/user-attachments/assets/da088d8e-538b-44b7-9d0d-2050c77c433a" />

Because i'm doing this in my own LAN, a simple config of `/etc/hosts` on the "victim" will do the trick. 
- <img width="480" height="246" alt="Screenshot from 2025-11-24 18-32-38" src="https://github.com/user-attachments/assets/aa2d44ab-002a-43d9-afa8-7d951aab4d16" />
- <img width="793" height="233" alt="Screenshot from 2025-11-24 22-19-05" src="https://github.com/user-attachments/assets/7008c467-8fbc-43a4-9031-109dca3ed735" />


I asked chatGPT to make me a dummy login site which I can use for in my own LAN. I had it create me a python flask app I can use for testing purposes.
### The dummy site works:
- <img width="1036" height="149" alt="Screenshot from 2025-11-24 22-04-44" src="https://github.com/user-attachments/assets/94dc1900-f76e-423b-a1a9-352ba2f436f3" />
- <img width="1226" height="421" alt="Screenshot from 2025-11-24 18-48-13" src="https://github.com/user-attachments/assets/091aa1d0-f20f-439a-94ab-5a92651047a5" />

## But does attack work?
I had so many problems getting evilginx to work with my ssl snakeoil certs
- <img width="1184" height="509" alt="Screenshot from 2025-11-24 18-51-32" src="https://github.com/user-attachments/assets/2255015f-e149-4e9c-b64e-358edd7a57c5" />
- So I tried to disable TLS.     

This is the setup I went with:
```bash
$ cat /usr/share/evilginx2/phishlets/dummy.yaml
```
**File:** `dummy.yaml`
```yaml
name: 'dummy'
author: 'aliG'
min_ver: '3.0.0'

proxy_hosts:
  - phish_sub: 'login'
    orig_sub: ''
    domain: 'safe-domain.com'
    session: true
    is_landing: true
    auto_filter: true

sub_filters:
  - phish_sub: 'login'
    orig_sub: ''
    triggers_on: 'login'
    domain: 'safe-domain.com'
    mimes: ['text/html', 'application/json', 'text/plain']
    search: 'safe-domain.com'
    replace: 'login.safe-domain.com'

auth_tokens:
  - name: 'sessionid'
    domain: 'safe-domain.com'
    path: '/'
    keys: ['sessionid']

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'

login:
  domain: 'safe-domain.com'
  path: '/login'

disable_tls: true
```

**File:** `~/.evilginx/config.json`
```json
{
  "blacklist": {
    "mode": "unauth"
  },
  "general": {
    "autocert": false,
    "bind_ipv4": "192.168.1.123",
    "dns_port": 53,
    "domain": "safe-domain.com",
    "external_ipv4": "192.168.1.123",
    "https_port": 443,
    "ipv4": "192.168.1.123",
    "redirect_http": false,
    "redirect_https": false,
    "ssl": false
  },
  "unauth_url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
  "gophish": {
    "admin_url": "",
    "api_key": "",
    "insecure": false
  },
  "phishlets": {
    "dummy": {
      "hostname": "safe-domain.com",
      "unauth_url": "",
      "enabled": true,
      "visible": true
    },
    "example": {
      "hostname": "",
      "unauth_url": "",
      "enabled": false,
      "visible": true
    }
  }
}       
```
## Execution:
- <img width="758" height="368" alt="Screenshot from 2025-11-24 22-15-52" src="https://github.com/user-attachments/assets/cb6395aa-078b-46b2-b3a3-5c1ff66980af" />
- But no, keeps timing out...
  - <img width="1129" height="651" alt="Screenshot from 2025-11-24 22-18-27" src="https://github.com/user-attachments/assets/0bebf411-e434-42af-815e-c918c9dd29e7" />

### Conclusion:
- This task was a fail for me, I will try to get it to work later.
- But it is what it is, we live and we learn!
- I guess you can't run this without TLS. So have to just figure it out.



**Sources:**
- <https://www.kali.org/tools/evilginx2/>
- <https://cilynx.com/how-to/evilginx2-vs-2fa-phishing/1908/>
- <https://github.com/kgretzky/evilginx2/wiki/FAQ>
- ChatGPT, Prompt: "Create me a dummy app I can use for testing evilginx"       
   



# B) Mininet. Create an environment, where you can do a TCP SYN-flood attack. Report on how you created the environment and executed the attack
Setting it up:
- Download image
  - Link provided by teacher
  - You can download it from here: <https://mininet.org/download/>
- Import it to VBox
  - <img width="954" height="573" alt="Screenshot from 2025-11-24 22-45-12" src="https://github.com/user-attachments/assets/6b6e8fc6-ca7f-415a-965b-167e68469712" />
- Start machine
- First order of business: `sudo loadkeys fi`

Now that the key map is all proper and nice, we can get down to actual business.

```
ryu-manager ryu.app.simple_switch_13
```
This effectively starts the controller.    

### Ryu?
- A quick "google search" (the AI summary at the top because i'm feeling lazy) tells us, that `ryu-manager` is used to manage ryu applications, which are really just tools for SDN (Software Defined Networking).
- Ryu in itself "is a component-based software defined networking framework"
- Source: <https://ryu-sdn.org/>
Anyway, when the switch is on, we can start the mininet environment using the command:
```bash
sudo mn --topo single,3 --mac --switch ovsk --controller remote
```
The command shortly (check mininet walkthrough for more (link in sources)):
- `mn` = MiniNet
- `--topo single,3` = Single topology, 3 hosts
- `--mac` = Tells mininet to use unique, small & easy to read addressing (mac & ip)
- `--switch ovsk` = Switch type: Open vSwitch
- `--controller remote` = This could also be started as `sudo mn --controller,ryu.app.simple_switch_13)`    
  - But because we started it earlier, we are effectively using it as a remote controller, and in this command telling mininet to use it.

<img width="781" height="726" alt="Screenshot from 2025-12-01 10-20-25" src="https://github.com/user-attachments/assets/f33c488e-a6dc-4a47-affd-c8e0538266d4" />     
> (Top of the screen: Started the switch)
> (Bottom of the screen: Fired up mininet)     

By pinging the machines in the mininet using `pingall`, we can confirm we have a connection (6/6 received).  
- <img width="438" height="144" alt="Screenshot from 2025-12-01 10-31-03" src="https://github.com/user-attachments/assets/be588fde-c2ff-49cb-8d35-69a466b93576" />      

I got tired of the black & white text lol, so I used SSH to connect to the VM from my primary laptop (FYI: so the sudden prompt change isn't confusing):
- <img width="837" height="248" alt="Screenshot 2025-12-01 at 11 34 29" src="https://github.com/user-attachments/assets/71e0e8f3-eabf-4d91-a252-cf07bf19153d" />     

Not able to open the window or terminal for the nodes, so have to run commands from the mininet prompt.
- <img width="426" height="104" alt="Screenshot 2025-12-01 at 13 04 38" src="https://github.com/user-attachments/assets/3d4d57ae-23fc-436b-ba1a-1b5eb0eb9c11" />
- 



Sources and reading:
- Mininet walkthrough
  - <https://mininet.org/walkthrough/>
- Commands
  - <https://www.geeksforgeeks.org/linux-unix/mininet-commands/>






